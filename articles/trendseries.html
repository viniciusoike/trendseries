<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with trendseries • trendseries</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with trendseries">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trendseries</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/trendseries.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced-methods.html">Advanced Trend Extraction Methods</a></li>
    <li><a class="dropdown-item" href="../articles/economic-filters.html">Economic Filters for Business Cycle Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/moving-averages.html">Moving Averages for Trend Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/viniciusoike/trendseries/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with trendseries</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/viniciusoike/trendseries/blob/main/vignettes/trendseries.Rmd" class="external-link"><code>vignettes/trendseries.Rmd</code></a></small>
      <div class="d-none name"><code>trendseries.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/viniciusoike/trendseries" class="external-link">trendseries</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">theme_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>paper <span class="op">=</span> <span class="st">"#fefefe"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># Use colors</span></span>
<span>    palette.colour.discrete <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"#024873FF"</span>,</span>
<span>      <span class="st">"#BF4F26FF"</span>,</span>
<span>      <span class="st">"#D98825FF"</span>,</span>
<span>      <span class="st">"#D9AA1EFF"</span>,</span>
<span>      <span class="st">"#A2A637FF"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="what-is-trendseries">What is trendseries?<a class="anchor" aria-label="anchor" href="#what-is-trendseries"></a>
</h2>
<p>The <code>trendseries</code> package helps you extract trends from
economic time series data. Think of trends as the underlying direction
of your data, stripped of short-term fluctuations and noise.</p>
<p>This vignette will walk you through the basics, starting with the
simplest possible example and gradually building up to more complex
analyses.</p>
<div class="section level3">
<h3 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h3>
<p>The main purpose of <code>trendseries</code> is to simplify the
workflow of trend extraction, especially when working with data frames
and grouped data. It provides two main functions:</p>
<ul>
<li>
<code><a href="../reference/augment_trends.html">augment_trends()</a></code>: Takes a data frame with a date column
and a value column, and adds new columns with the extracted trends using
specified methods.</li>
<li>
<code><a href="../reference/extract_trends.html">extract_trends()</a></code>: Takes a single time series object
(<code>ts</code>) and returns the extracted trends.</li>
</ul>
<p>Tabular data frames are the most common format for time series data
in R, but most trend extraction methods are designed for <code>ts</code>
objects. <code>trendseries</code> bridges this gap, allowing you to work
directly with data frames without cumbersome conversions.
<code>trendseries</code> was designed to work fluidly with
<code>tidyverse</code> tools like <code>dplyr</code> and
<code>ggplot2</code>.</p>
<p>This package was designed with economic time series in mind, in this
sense, it includes methods commonly used in economics (e.g.,
Hodrick-Prescott filter) as well as general-purpose smoothing methods
(e.g., LOESS, moving averages).</p>
</div>
<div class="section level3">
<h3 id="your-first-trend-analysis">Your First Trend Analysis<a class="anchor" aria-label="anchor" href="#your-first-trend-analysis"></a>
</h3>
<p>Let’s start with the simplest possible example: extracting a trend
from Brazilian GDP construction data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gdp_construction"</span>, package <span class="op">=</span> <span class="st">"trendseries"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Take a quick look</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gdp_construction</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   date       gdp_construction</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1995-01-01            100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1995-04-01            100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1995-07-01            100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1995-10-01            100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1996-01-01             97.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1996-04-01            101.</span></span></code></pre></div>
<p>This dataset contains quarterly observations of Brazil’s construction
sector GDP. Let’s extract a trend using the Hodrick-Prescott (HP)
filter, one of the most common methods in economics.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract trend using HP filter</span></span>
<span><span class="va">gdp_with_trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>  <span class="va">gdp_construction</span>,</span>
<span>  value_col <span class="op">=</span> <span class="st">"gdp_construction"</span>,</span>
<span>  methods <span class="op">=</span> <span class="st">"hp"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Auto-detected quarterly (4 obs/year)</span></span>
<span><span class="co">#&gt; Computing HP filter (two-sided) with lambda = 1600</span></span>
<span></span>
<span><span class="co"># View the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gdp_with_trend</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   date       gdp_construction trend_hp</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1995-01-01            100       101.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1995-04-01            100       101.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1995-07-01            100       102.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1995-10-01            100       103.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1996-01-01             97.8     103.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1996-04-01            101.      104.</span></span></code></pre></div>
<p>That’s it! The <code><a href="../reference/augment_trends.html">augment_trends()</a></code> function added a new
column called <code>trend_hp</code> to your data. The original data
stays intact, and you get a new column with the trend.</p>
</div>
<div class="section level3">
<h3 id="visualizing-your-first-trend">Visualizing Your First Trend<a class="anchor" aria-label="anchor" href="#visualizing-your-first-trend"></a>
</h3>
<p>Let’s see what this trend looks like.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data for plotting</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">gdp_with_trend</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">gdp_construction</span>, <span class="va">trend_hp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gdp_construction</span>, <span class="va">trend_hp</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"series"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    series <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">series</span> <span class="op">==</span> <span class="st">"gdp_construction"</span> <span class="op">~</span> <span class="st">"Data (original)"</span>,</span>
<span>      <span class="va">series</span> <span class="op">==</span> <span class="st">"trend_hp"</span> <span class="op">~</span> <span class="st">"HP Filter Trend"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">series</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Brazil GDP Construction: Original vs Trend"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Construction Index"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_series</span></span></code></pre></div>
<p><img src="trendseries_files/figure-html/plot-first-trend-1.png" width="672"></p>
<p>Notice how the trend smooths out the short-term fluctuations in the
original data. This makes it easier to see the long-term direction of
the construction sector.</p>
</div>
<div class="section level3">
<h3 id="what-if-my-data-is-a-sinlge-time-series">What if my data is a sinlge time series?<a class="anchor" aria-label="anchor" href="#what-if-my-data-is-a-sinlge-time-series"></a>
</h3>
<p>If your data is already a <code>ts</code> object, you can use the
<code><a href="../reference/extract_trends.html">extract_trends()</a></code> function directly. This is useful for
quick analyses or when working with single series.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span></span>
<span>  <span class="va">gdp_construction</span><span class="op">$</span><span class="va">gdp_construction</span>,</span>
<span>  frequency <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1996</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gdp_trend_hp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_trends.html">extract_trends</a></span><span class="op">(</span><span class="va">gdp</span>, <span class="st">"hp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing HP filter (two-sided) with lambda = 1600</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="trying-different-trend-methods">Trying Different Trend Methods<a class="anchor" aria-label="anchor" href="#trying-different-trend-methods"></a>
</h3>
<p>The HP filter is just one way to extract trends. Let’s compare it
with two other popular methods.</p>
<ul>
<li>
<strong>HP filter</strong>: Standard choice in macroeconomics</li>
<li>
<strong>LOESS</strong>: Local polynomial smoothing</li>
<li>
<strong>Moving Average (MA)</strong>: Simple average of nearby
points</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract multiple trends at once</span></span>
<span><span class="va">gdp_comparison</span> <span class="op">&lt;-</span> <span class="va">gdp_construction</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>    value_col <span class="op">=</span> <span class="st">"gdp_construction"</span>,</span>
<span>    methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hp"</span>, <span class="st">"loess"</span>, <span class="st">"ma"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Auto-detected quarterly (4 obs/year)</span></span>
<span><span class="co">#&gt; Computing HP filter (two-sided) with lambda = 1600</span></span>
<span><span class="co">#&gt; Computing loess trend with span = 0.75</span></span>
<span><span class="co">#&gt; Computing 2x{window}-period moving average with center alignment</span></span>
<span></span>
<span><span class="co"># View the first few rows</span></span>
<span><span class="va">gdp_comparison</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">gdp_construction</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"trend_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   date       gdp_construction trend_hp trend_loess trend_ma</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1995-01-01            100       101.        109.     <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1995-04-01            100       101.        109.    100  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1995-07-01            100       102.        108.     99.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1995-10-01            100       103.        107.     99.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1996-01-01             97.8     103.        107.    102. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1996-04-01            101.      104.        106.    102.</span></span></code></pre></div>
<p>Now let’s visualize all three methods:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data for plotting</span></span>
<span><span class="va">comparison_plot</span> <span class="op">&lt;-</span> <span class="va">gdp_comparison</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">gdp_construction</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"trend_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gdp_construction</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"trend_"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"method"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">method</span> <span class="op">==</span> <span class="st">"gdp_construction"</span> <span class="op">~</span> <span class="st">"Data (original)"</span>,</span>
<span>      <span class="va">method</span> <span class="op">==</span> <span class="st">"trend_hp"</span> <span class="op">~</span> <span class="st">"HP Filter"</span>,</span>
<span>      <span class="va">method</span> <span class="op">==</span> <span class="st">"trend_loess"</span> <span class="op">~</span> <span class="st">"LOESS"</span>,</span>
<span>      <span class="va">method</span> <span class="op">==</span> <span class="st">"trend_ma"</span> <span class="op">~</span> <span class="st">"Moving Average"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">comparison_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comparing Different Trend Extraction Methods"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Same data, different methods"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Construction Index"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Method"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_series</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="trendseries_files/figure-html/plot-comparison-1.png" width="672"></p>
<p>Each method produces a slightly different trend. The HP filter and
LOESS are quite similar, while the moving average is slightly more
responsive to changes in the data.</p>
</div>
<div class="section level3">
<h3 id="working-with-monthly-data">Working with Monthly Data<a class="anchor" aria-label="anchor" href="#working-with-monthly-data"></a>
</h3>
<p>So far we’ve used quarterly data (4 observations per year). Let’s try
monthly data, which is more common in economic analysis.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load monthly vehicle production data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"vehicles"</span>, package <span class="op">=</span> <span class="st">"trendseries"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at recent data (last 4 years)</span></span>
<span><span class="va">recent_vehicles</span> <span class="op">&lt;-</span> <span class="va">vehicles</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_tail</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">recent_vehicles</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   date       vehicles</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2021-08-01   <span style="text-decoration: underline;">178</span>900</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2021-09-01   <span style="text-decoration: underline;">156</span>803</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2021-10-01   <span style="text-decoration: underline;">170</span>178</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2021-11-01   <span style="text-decoration: underline;">176</span>322</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2021-12-01   <span style="text-decoration: underline;">219</span>446</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2022-01-01   <span style="text-decoration: underline;">136</span>105</span></span></code></pre></div>
<p>The process is exactly the same - <code><a href="../reference/augment_trends.html">augment_trends()</a></code>
automatically detects the frequency.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract trend from monthly data</span></span>
<span><span class="va">vehicles_with_trend</span> <span class="op">&lt;-</span> <span class="va">vehicles</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>    value_col <span class="op">=</span> <span class="st">"vehicles"</span>,</span>
<span>    methods <span class="op">=</span> <span class="st">"hp"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Auto-detected monthly (12 obs/year)</span></span>
<span><span class="co">#&gt; Computing HP filter (two-sided) with lambda = 14400</span></span>
<span></span>
<span><span class="va">vehicles_with_trend</span> <span class="op">&lt;-</span> <span class="va">vehicles_with_trend</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vehicles</span>, <span class="va">trend_hp</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"series"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">series</span> <span class="op">==</span> <span class="st">"vehicles"</span>, <span class="st">"Original"</span>, <span class="st">"HP Trend"</span><span class="op">)</span>,</span>
<span>    <span class="co"># To make sure the trend is plotted on top of the original series</span></span>
<span>    <span class="co"># configure levels accordingly</span></span>
<span>    series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">series</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"HP Trend"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">vehicles_with_trend</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">series</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Brazil Vehicle Production: Monthly Data"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Last 4 years of data"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Production (thousands of units)"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_series</span></span></code></pre></div>
<p><img src="trendseries_files/figure-html/monthly-trend-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="understanding-parameters-window-and-smoothing">Understanding Parameters: Window and Smoothing<a class="anchor" aria-label="anchor" href="#understanding-parameters-window-and-smoothing"></a>
</h3>
<p>Different trend methods accept different parameters. The
<code>trendseries</code> package simplifies this with two main
parameters:</p>
<ul>
<li>
<strong><code>window</code></strong>: Controls the period for moving
averages (e.g., 12 months)</li>
<li>
<strong><code>smoothing</code></strong>: Controls how smooth the
trend should be</li>
</ul>
<p>Let’s experiment with the <code>window</code> parameter for a moving
average.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Try different window sizes</span></span>
<span><span class="va">vehicles_windows</span> <span class="op">&lt;-</span> <span class="va">recent_vehicles</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>    value_col <span class="op">=</span> <span class="st">"vehicles"</span>,</span>
<span>    methods <span class="op">=</span> <span class="st">"ma"</span>,</span>
<span>    window <span class="op">=</span> <span class="fl">6</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>trend_ma_6m <span class="op">=</span> <span class="va">trend_ma</span><span class="op">)</span></span>
<span><span class="co">#&gt; Auto-detected monthly (12 obs/year)</span></span>
<span><span class="co">#&gt; Computing {window}-period moving average with center alignment</span></span>
<span></span>
<span><span class="co"># Add 12-month window</span></span>
<span><span class="va">vehicles_windows</span> <span class="op">&lt;-</span> <span class="va">vehicles_windows</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>    value_col <span class="op">=</span> <span class="st">"vehicles"</span>,</span>
<span>    methods <span class="op">=</span> <span class="st">"ma"</span>,</span>
<span>    window <span class="op">=</span> <span class="fl">12</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Auto-detected monthly (12 obs/year)</span></span>
<span><span class="co">#&gt; Computing 2x{window}-period moving average with center alignment</span></span>
<span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="va">vehicles_windows</span> <span class="op">&lt;-</span> <span class="va">vehicles_windows</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">vehicles</span>, <span class="va">trend_ma_6m</span>, <span class="va">trend_ma</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vehicles</span>, <span class="va">trend_ma_6m</span>, <span class="va">trend_ma</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"method"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">method</span> <span class="op">==</span> <span class="st">"vehicles"</span> <span class="op">~</span> <span class="st">"Data (original)"</span>,</span>
<span>      <span class="va">method</span> <span class="op">==</span> <span class="st">"trend_ma_6m"</span> <span class="op">~</span> <span class="st">"MA (6-month)"</span>,</span>
<span>      <span class="va">method</span> <span class="op">==</span> <span class="st">"trend_ma"</span> <span class="op">~</span> <span class="st">"MA (12-month)"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">vehicles_windows</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Window Size Comparison"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Larger windows = smoother trends"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Production (thousands)"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_series</span></span>
<span><span class="co">#&gt; Warning: Removed 16 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="trendseries_files/figure-html/window-param-1.png" width="672"></p>
<p><strong>Key insight</strong>: Larger windows produce smoother trends
but are slower to react to changes. Smaller windows track the data more
closely but may still include some noise.</p>
<p>For monthly data: - Short-term trend: <code>window = 3</code> to
<code>6</code> - Medium-term trend: <code>window = 12</code> (one year)
- Long-term trend: <code>window = 24</code> or more</p>
</div>
<div class="section level3">
<h3 id="working-with-multiple-series">Working with Multiple Series<a class="anchor" aria-label="anchor" href="#working-with-multiple-series"></a>
</h3>
<p>A common task is comparing trends across different time-series. Let’s
look at economic activity and vehicle production together.
<code><a href="../reference/augment_trends.html">augment_trends()</a></code> can handle this easily with the
<code>group_vars</code> argument.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ibcbr"</span>, package <span class="op">=</span> <span class="st">"trendseries"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">ibcbr</span>, <span class="va">vehicles</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">series</span> <span class="op">&lt;-</span> <span class="va">series</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2010-01-01"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ibcbr</span>, <span class="va">vehicles</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"indicator"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Normalize to Jan 2010 = 100 for comparison</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    index <span class="op">=</span> <span class="va">value</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">first</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">indicator</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">series</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>  <span class="va">series</span>,</span>
<span>  value_col <span class="op">=</span> <span class="st">"index"</span>,</span>
<span>  methods <span class="op">=</span> <span class="st">"hp"</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="st">"indicator"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Auto-detected monthly (12 obs/year)</span></span>
<span><span class="co">#&gt; Computing HP filter (two-sided) with lambda = 14400</span></span>
<span><span class="co">#&gt; Auto-detected monthly (12 obs/year)</span></span>
<span><span class="co">#&gt; Computing HP filter (two-sided) with lambda = 14400</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot trends only</span></span>
<span><span class="va">series</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, color <span class="op">=</span> <span class="va">indicator</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">index</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">trend_hp</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Economic Indicators: HP Filter Trends"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Normalized to first observation = 100"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Index (normalized)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Indicator"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">theme_series</span></span></code></pre></div>
<p><img src="trendseries_files/figure-html/multi-series-1.png" width="672"></p>
<p>This shows both series moved together during the pandemic period but
diverged afterwards, with economic activity recovering more strongly
than vehicle production.</p>
</div>
<div class="section level3">
<h3 id="available-trend-methods">Available Trend Methods<a class="anchor" aria-label="anchor" href="#available-trend-methods"></a>
</h3>
<p>The <code>trendseries</code> package supports many trend extraction
methods. Here are the most commonly used:</p>
<div class="section level4">
<h4 id="economiceconometric-filters">Economic/Econometric Filters<a class="anchor" aria-label="anchor" href="#economiceconometric-filters"></a>
</h4>
<ul>
<li>
<strong><code>hp</code></strong>: Hodrick-Prescott filter (default,
widely used in macroeconomics)</li>
<li>
<strong><code>bk</code></strong>: Baxter-King bandpass filter
(isolates business cycles)</li>
<li>
<strong><code>cf</code></strong>: Christiano-Fitzgerald filter
(asymmetric bandpass)</li>
<li>
<strong><code>hamilton</code></strong>: Hamilton regression filter
(recent alternative to HP)</li>
</ul>
</div>
<div class="section level4">
<h4 id="moving-averages">Moving Averages<a class="anchor" aria-label="anchor" href="#moving-averages"></a>
</h4>
<ul>
<li>
<strong><code>ma</code></strong>: Simple moving average (easiest to
understand)</li>
<li>
<strong><code>ewma</code></strong>: Exponentially weighted moving
average (more weight on recent data)</li>
<li>
<strong><code>wma</code></strong>: Weighted moving average
(emphasizes recent observations)</li>
<li>
<strong><code>zlema</code></strong>: Zero-lag exponential moving
average (reduced lag)</li>
<li>
<strong><code>triangular</code></strong>: Triangular moving average
(double-smoothed)</li>
</ul>
</div>
<div class="section level4">
<h4 id="smoothing-methods">Smoothing Methods<a class="anchor" aria-label="anchor" href="#smoothing-methods"></a>
</h4>
<ul>
<li>
<strong><code>loess</code></strong>: Local polynomial regression
(flexible, data-adaptive)</li>
<li>
<strong><code>spline</code></strong>: Smoothing splines (very
smooth)</li>
<li>
<strong><code>stl</code></strong>: Seasonal-trend decomposition
(handles seasonality)</li>
</ul>
</div>
<div class="section level4">
<h4 id="advanced-methods">Advanced Methods<a class="anchor" aria-label="anchor" href="#advanced-methods"></a>
</h4>
<ul>
<li>
<strong><code>sg</code></strong>: Savitzky-Golay filter (preserves
features like peaks)</li>
<li>
<strong><code>kalman</code></strong>: Kalman smoother (optimal under
certain assumptions)</li>
<li>
<strong><code>kernel</code></strong>: Kernel regression smoother
(nonparametric)</li>
</ul>
<p><strong>Recommendation for beginners</strong>: Start with
<code>hp</code> for general use, <code>ma</code> when you want something
simple and interpretable, and <code>stl</code> when your data has clear
seasonal patterns.</p>
</div>
</div>
<div class="section level3">
<h3 id="quick-reference-common-patterns">Quick Reference: Common Patterns<a class="anchor" aria-label="anchor" href="#quick-reference-common-patterns"></a>
</h3>
<p>Here are some ready-to-use patterns for common scenarios:</p>
<div class="section level4">
<h4 id="basic-trend-extraction">Basic trend extraction<a class="anchor" aria-label="anchor" href="#basic-trend-extraction"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Single method, quarterly data</span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span>value_col <span class="op">=</span> <span class="st">"your_column"</span>, methods <span class="op">=</span> <span class="st">"hp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Single series, monthly data</span></span>
<span><span class="fu"><a href="../reference/extract_trends.html">extract_trends</a></span><span class="op">(</span><span class="va">your_ts_data</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="compare-multiple-methods">Compare multiple methods<a class="anchor" aria-label="anchor" href="#compare-multiple-methods"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>    value_col <span class="op">=</span> <span class="st">"your_column"</span>,</span>
<span>    methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hp"</span>, <span class="st">"loess"</span>, <span class="st">"ma"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="control-smoothness">Control smoothness<a class="anchor" aria-label="anchor" href="#control-smoothness"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Smoother HP filter (higher lambda)</span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>    value_col <span class="op">=</span> <span class="st">"your_column"</span>,</span>
<span>    methods <span class="op">=</span> <span class="st">"hp"</span>,</span>
<span>    smoothing <span class="op">=</span> <span class="fl">3200</span>  <span class="co"># vs default 1600 for quarterly</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Longer moving average window</span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>    value_col <span class="op">=</span> <span class="st">"your_column"</span>,</span>
<span>    methods <span class="op">=</span> <span class="st">"ma"</span>,</span>
<span>    window <span class="op">=</span> <span class="fl">24</span>  <span class="co"># 2-year window for monthly data</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="grouped-data">Grouped data<a class="anchor" aria-label="anchor" href="#grouped-data"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply trend to multiple series at once</span></span>
<span><span class="va">multi_series_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span>value_col <span class="op">=</span> <span class="st">"gdp"</span>, methods <span class="op">=</span> <span class="st">"hp"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or using group_vars argument</span></span>
<span><span class="va">multi_series_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/augment_trends.html">augment_trends</a></span><span class="op">(</span></span>
<span>    value_col <span class="op">=</span> <span class="st">"gdp"</span>,</span>
<span>    methods <span class="op">=</span> <span class="st">"hp"</span>,</span>
<span>    group_vars <span class="op">=</span> <span class="st">"country"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h3>
<p>Now that you understand the basics, you can:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Explore specific methods in depth</strong>: Check out the
“Moving Averages” vignette for detailed analysis of MA methods.</li>
<li>
<strong>Learn about economic filters</strong>: See the “Economic
Filters” vignette for HP, BK, and CF filters.</li>
<li>
<strong>Try advanced methods</strong>: Explore STL decomposition,
Kalman filtering, and more in the “Advanced Methods” vignette.</li>
<li>
<strong>Read the function documentation</strong>:
<code><a href="../reference/augment_trends.html">?augment_trends</a></code> and <code><a href="../reference/extract_trends.html">?extract_trends</a></code>.</li>
</ol>
</div>
<div class="section level3">
<h3 id="built-in-datasets">Built-in Datasets<a class="anchor" aria-label="anchor" href="#built-in-datasets"></a>
</h3>
<p>The package includes several economic datasets for practice.</p>
<div class="section level4">
<h4 id="brazilian-economic-data">Brazilian Economic Data<a class="anchor" aria-label="anchor" href="#brazilian-economic-data"></a>
</h4>
<p>All series are monthly except for <code>gdp_construction</code>. -
<strong><code>ibcbr</code></strong>: Central Bank Economic Activity
Index - smooth, good for learning -
<strong><code>vehicles</code></strong>: Vehicle production - cyclical,
interesting patterns - <strong><code>electric</code></strong>:
Electricity consumption - seasonal patterns -
<strong><code>oil_derivatives</code></strong>: Oil derivatives
production - <strong><code>gdp_construction</code></strong>: GDP
construction index - smooth, great for first examples</p>
</div>
<div class="section level4">
<h4 id="international-data">International Data<a class="anchor" aria-label="anchor" href="#international-data"></a>
</h4>
<ul>
<li>
<strong><code>retail_households</code></strong>: UK household goods
retail (monthly)</li>
<li>
<strong><code>retail_autofuel</code></strong>: UK automotive fuel
retail (monthly)</li>
<li>
<strong><code>coffee_arabica</code></strong>: Coffee prices
(daily)</li>
<li>
<strong><code>coffee_robusta</code></strong>: Coffee prices
(daily)</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="faq">FAQ<a class="anchor" aria-label="anchor" href="#faq"></a>
</h2>
<div class="section level3">
<h3 id="how-is-trendseries-easier-than-the-traditional-workflow">How is <code>trendseries</code> easier than the traditional
workflow?<a class="anchor" aria-label="anchor" href="#how-is-trendseries-easier-than-the-traditional-workflow"></a>
</h3>
<p>Time series have a specific structure in R (<code>ts</code>) and most
filtering methods are designed for <code>ts</code> objects. However,
datasets come as data frames with date columns, which can make applying
filters cumbersome.</p>
<p>The usual workflow involves (1) converting individual columns to
<code>ts</code>, (2) applying the filter, (3) and then converting back
to a <code>data.frame</code>. This can be cumbersome, especially when
working with multiple series or grouped data. Merging back the results
with the original data can also be error-prone due to misalignment of
dates and additional <code>NA</code> values introduced by some
filters.</p>
<p>For instance, to replicate the first example in this vignette,
without <code>trendseries</code>, you would have to first convert the
data frame to a <code>ts</code> object, mannually inputing both
<code>frequency</code> and <code>start</code> parameters:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdp_cons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span></span>
<span>  <span class="va">gdp_construction</span><span class="op">$</span><span class="va">gdp_construction</span>,</span>
<span>  frequency <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1996</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or, using lubridate to extract year and month</span></span>
<span><span class="va">gdp_cons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span></span>
<span>  <span class="va">gdp_construction</span><span class="op">$</span><span class="va">gdp_construction</span>,</span>
<span>  frequency <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">gdp_construction</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/quarter.html" class="external-link">quarter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">gdp_construction</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then apply the HP filter using the <code>mFilter</code> package.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdp_trend_hp</span> <span class="op">&lt;-</span> <span class="fu">mFilter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mFilter/man/hpfilter.html" class="external-link">hpfilter</a></span><span class="op">(</span><span class="va">gdp_cons</span>, <span class="fl">1600</span><span class="op">)</span></span></code></pre></div>
<p>And finally, convert it back to a <code>data.frame</code> and merge
with the original data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert back to data frame using tsbox</span></span>
<span><span class="va">trend_df</span> <span class="op">&lt;-</span> <span class="fu">tsbox</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/tsbox/reference/ts_ts.html" class="external-link">ts_df</a></span><span class="op">(</span><span class="va">gdp_trend_hp</span><span class="op">$</span><span class="va">trend</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">trend_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"trend_hp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join with original data</span></span>
<span><span class="va">gdp_manual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">gdp_construction</span>, <span class="va">trend_df</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="what-are-the-alternatives-to-trendseries">What are the alternatives to <code>trendseries</code>?<a class="anchor" aria-label="anchor" href="#what-are-the-alternatives-to-trendseries"></a>
</h3>
<p>The closest alternative to <code>trendseries</code> is the
<code>tsibble</code>/<code>fable</code> ecosystem, which provides a
<code>model()</code> function for applying models — including some trend
extraction methods — to grouped time series. Like
<code>trendseries</code>, these packages integrate well with
<code>tidyverse</code> tools and pipes.</p>
<p>However, <code>fable</code> was designed primarily for forecasting,
which means its trend extraction capabilities are more limited. They
also lack some popular methods commonly used by economists, such as the
HP filter and the Hamilton filter.</p>
<p>Additionally, these packages require using the <code>tsibble</code>
data structure, which pulls users away from the familiar
<code>data.frame</code>/<code>tibble</code> format. For users working
with just a few time series and relying on R’s built-in <code>ts</code>
functionality, the <code>tsibble</code> structure can feel unnecessarily
complex.</p>
</div>
<div class="section level3">
<h3 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h3>
<p>This package was inspired by the need for a simpler workflow for
trend extraction in R. It builds upon many existing packages,
including:</p>
<ul>
<li>
<code>mFilter</code> for economic filters.</li>
<li>
<code>hpfilter</code> for Hodrick-Prescott filtering.</li>
<li>
<code>signal</code> for Savitzky-Golay filtering.</li>
<li>
<code>TTR</code> and <code>zoo</code> for efficient moving
averages.</li>
<li>
<code>tsbox</code> for time series conversions.</li>
</ul>
</div>
<div class="section level3">
<h3 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<p>If you run into issues:</p>
<ul>
<li>Check the documentation: <code><a href="../reference/augment_trends.html">?augment_trends</a></code>
</li>
<li>View examples: <code>example(augment_trends)</code>
</li>
<li>Read other vignettes:
<code>vignette(package = "trendseries")</code>
</li>
<li>Report bugs: GitHub issues</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vinicius Oike.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
